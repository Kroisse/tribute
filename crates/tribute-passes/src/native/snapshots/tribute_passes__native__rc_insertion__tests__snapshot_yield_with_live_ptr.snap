---
source: crates/tribute-passes/src/native/rc_insertion.rs
assertion_line: 1272
expression: ir
---
core.module @test {
  clif.func {sym_name = @yield_and_use, type = core.func(core.ptr, core.ptr)} {
  ^bb1(%p: core.ptr):
    %0 = tribute_rt.retain %p : core.ptr
    %1 = clif.iconst {value = 1} : core.i32
    %2 = clif.iconst {value = 0} : core.i32
    %3 = tribute_rt.retain %p : core.ptr
    %4 = clif.iconst {value = 16} : core.i64
    %5 = clif.call %4 {callee = @__tribute_alloc} : core.ptr
    clif.store %p, %5 {offset = 0}
    %6 = clif.iconst {value = 0} : core.i64
    clif.store %6, %5 {offset = 8}
    %7 = clif.iconst {value = 1} : core.i32
    %8 = clif.call %5, %7 {callee = @__tribute_yield_set_rc_roots} : core.nil
    %9 = clif.call %1, %2, %p {callee = @__tribute_yield} : core.ptr
    tribute_rt.release %p {alloc_size = 0}
    tribute_rt.release %9 {alloc_size = 0}
    clif.return %p
  }
}
